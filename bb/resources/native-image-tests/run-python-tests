#!/usr/bin/env bash

set -o errexit
set -o pipefail
set -o nounset

echo "Setting up Python test environment..."

# Set library paths so Python can find libdatahike.so
export LD_LIBRARY_PATH=./libdatahike/target
export DYLD_LIBRARY_PATH=./libdatahike/target

# Install pytest (use pip3 explicitly to avoid Python 2.7)
echo "Installing pytest..."
pip3 install --user pytest

# Run Python tests using python3 -m pytest to avoid PATH issues
echo "Running Python tests..."
cd pydatahike
python3 -m pytest -v tests/

echo "Python tests completed successfully!"
